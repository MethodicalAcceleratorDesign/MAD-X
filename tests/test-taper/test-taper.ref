
  ++++++++++++++++++++++++++++++++++++++++++++
  +     MAD-X 5.08.01  (64 bit, Darwin)      +
  + Support: mad@cern.ch, http://cern.ch/mad +
  + Release   date: 2022.02.25               +
  + Execution date: 2022.03.07 17:28:10      +
  ++++++++++++++++++++++++++++++++++++++++++++
! Test/Demo file for TAPER command and TAPERING flag for TWISS

!

! 2021-08-13 Ghislain Roy



Option, -echo, -info;



Set, format="-20s","23.17g";



Select, flag=twiss, column=name,keyword,s,x,px,y,py,t,pt;



Beam, particle=electron, PC=182.5, radiate;



Use, sequence = FCC_E_RING;



! Without tapering Twiss will fail

Twiss; 

enter Twiss module
  
iteration:   1 error:   3.985885E-04 deltap:   0.000000E+00
orbit:   4.449744E-06  1.053100E-05  0.000000E+00  0.000000E+00 -7.375850E-04  8.928131E-05
  
iteration:   2 error:   9.890901E-06 deltap:   0.000000E+00
orbit:   4.542147E-06  1.121460E-05  0.000000E+00  0.000000E+00 -7.555235E-04  9.179113E-05
  
iteration:   3 error:   2.477758E-07 deltap:   0.000000E+00
orbit:   4.551192E-06  1.125545E-05  0.000000E+00  0.000000E+00 -7.559763E-04  9.184437E-05
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCPIN:  Mode 1 is unstable for delta(p)/p =     0.000000: cosmux =     1.151538, cosmuy =    -0.919950                                                        
++++++ Error: seterrorflag : Errorcode: 1   Reported from pro_twiss:
++++++ Error: seterrorflag : Description: TWISS failed
++++++ warning: Twiss failed:  MAD-X continues


! Taper with all default values

Taper;

  
iteration:   1 error:   2.134290E-10 deltap:   0.000000E+00
orbit:  -3.018286E-13  5.695089E-13  0.000000E+00  0.000000E+00 -4.063248E-10 -6.183646E-12
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
Twiss, save, file="taper-def.tfs";

enter Twiss module
  
iteration:   1 error:   2.126608E-10 deltap:   0.000000E+00
orbit:  -3.009187E-13  5.694555E-13  0.000000E+00  0.000000E+00 -4.455048E-10 -1.166410E-10
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.

++++++ table: summ

                 length                  orbit5                    alfa                 gammatr 
     97756.072627066169  4.4550481704525163e-10  6.7368976041691678e-06      385.27428822113922 

                     q1                     dq1                 betxmax                   dxmax 
     389.05942327459877     0.97242839370854939      1619.4277922426877     0.53578797772049525 

                  dxrms                  xcomax                  xcorms                      q2 
    0.12376338920965217  6.6070643274062076e-11  1.8574886412560957e-11      389.17276467241669 

                    dq2                 betymax                   dymax                   dyrms 
   -0.81165641418256373      7121.1444419741511                      -0                       0 

                 ycomax                  ycorms                  deltap                 synch_1 
                      0                       0                       0                       0 

                synch_2                 synch_3                 synch_4                 synch_5 
                      0                       0                       0                       0 

                synch_6                 synch_8                  nflips                   dqmin 
                      0                       0                       0                       0 

            dqmin_phase 
                      0 


! Check parameters and guards

! non default parameters

Taper, iterate=2, stepsize=2.e-6, file="test1.madx";  

initial orbit vector:   0.000000E+00  0.000000E+00  0.000000E+00  0.000000E+00  0.000000E+00  0.000000E+00
first taper value:   0.000000E+00 nsteps:        0
 
final orbit vector:       1.750085E-09  2.757027E-08  0.000000E+00  0.000000E+00 -1.142053E-08  3.069912E-09
last taper value:    0.000000E+00 nsteps:        0


! negative values for iterate and stepsize

Taper, iterate=-11, stepsize=-2.e-3, file;

++++++ warning: negative value for ITERATE,  reset to absolute value
++++++ warning: ITERATE value larger than 10 is probably useless,  reset to 10.
++++++ warning: negative value for STEPSIZE,  reset to absolute value
initial orbit vector:   0.000000E+00  0.000000E+00  0.000000E+00  0.000000E+00  0.000000E+00  0.000000E+00
first taper value:   0.000000E+00 nsteps:        0
 
final orbit vector:       3.009294E-04  1.540718E-05  0.000000E+00  0.000000E+00 -1.102895E-06 -3.242720E-04
last taper value:    0.000000E+00 nsteps:        0


! initial closed orbit will be taken into account

Coguess, pt=1.e-4 ;

Taper, file="coguess.madx";

 Found initial orbit vector from COGUESS values. 
  
iteration:   1 error:   1.402770E-05 deltap:   0.000000E+00
orbit:   1.033604E-10 -2.421153E-11  0.000000E+00  0.000000E+00  2.400125E-05  9.305407E-05
  
iteration:   2 error:   6.823880E-07 deltap:   0.000000E+00
orbit:   7.693534E-12  5.781802E-12  0.000000E+00  0.000000E+00  2.516936E-05  9.271617E-05
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
Coguess, clear ;



Taper;

  
iteration:   1 error:   2.134290E-10 deltap:   0.000000E+00
orbit:  -3.018286E-13  5.695089E-13  0.000000E+00  0.000000E+00 -4.063248E-10 -6.183646E-12
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
! and with effect of deltap

Twiss, deltap=1.e-3, save, file="taper_dp.tfs";

enter Twiss module
  
iteration:   1 error:   1.105442E-04 deltap:   1.000000E-03
orbit:  -9.135213E-08  4.123017E-07  0.000000E+00  0.000000E+00  1.835133E-04 -7.030935E-05
  
iteration:   2 error:   6.193924E-07 deltap:   1.000000E-03
orbit:  -1.224543E-07  4.132685E-07  0.000000E+00  0.000000E+00  1.823771E-04 -7.092048E-05
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.

++++++ table: summ

                 length                  orbit5                    alfa                 gammatr 
     97756.072627066169 -0.00018237711358402414  6.7518035614360974e-06      384.84876819764219 

                     q1                     dq1                 betxmax                   dxmax 
     389.05994144349938      2.5267238136641144      1657.4217367203967     0.54451469821232379 

                  dxrms                  xcomax                  xcorms                      q2 
    0.12399229456044844  0.00049831653645340031  0.00011498785700409634      389.17726275310321 

                    dq2                 betymax                   dymax                   dyrms 
     7.3076027158119627      6848.9451700842992                      -0                       0 

                 ycomax                  ycorms                  deltap                 synch_1 
                      0                       0                   0.001                       0 

                synch_2                 synch_3                 synch_4                 synch_5 
                      0                       0                       0                       0 

                synch_6                 synch_8                  nflips                   dqmin 
                      0                       0                       0                       0 

            dqmin_phase 
                      0 


! relative tapering

Taper, stepsize=7.e-4, file="test2.madx";

initial orbit vector:   0.000000E+00  0.000000E+00  0.000000E+00  0.000000E+00  0.000000E+00  0.000000E+00
first taper value:   0.000000E+00 nsteps:        0
 
final orbit vector:       4.667994E-06 -2.145345E-05  0.000000E+00  0.000000E+00 -6.331559E-07 -2.343720E-05
last taper value:    0.000000E+00 nsteps:        0
Twiss, save, file="taper_rel.tfs";

enter Twiss module
  
iteration:   1 error:   2.343720E-05 deltap:   0.000000E+00
orbit:  -8.651900E-05 -1.607450E-05  0.000000E+00  0.000000E+00  3.969521E-05 -1.233403E-05
  
iteration:   2 error:   7.180859E-05 deltap:   0.000000E+00
orbit:  -9.009318E-05 -2.132567E-05  0.000000E+00  0.000000E+00  1.769175E-04 -9.113768E-06
  
iteration:   3 error:   1.204879E-05 deltap:   0.000000E+00
orbit:  -8.977940E-05 -2.170555E-05  0.000000E+00  0.000000E+00  1.996477E-04 -9.531907E-06
  
iteration:   4 error:   2.993341E-07 deltap:   0.000000E+00
orbit:  -8.973970E-05 -2.169158E-05  0.000000E+00  0.000000E+00  2.001817E-04 -9.626696E-06
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.

++++++ table: summ

                 length                  orbit5                    alfa                 gammatr 
     97756.072627066169 -0.00020018172110926587  6.7394090738694238e-06      385.20249447387891 

                     q1                     dq1                 betxmax                   dxmax 
     389.04832633407602     -1.6171646683361944       2209.943350510609     0.59640255513351048 

                  dxrms                  xcomax                  xcorms                      q2 
    0.13094998116367318   0.0055845380333732243  0.00067445990874272406      389.16892121998353 

                    dq2                 betymax                   dymax                   dyrms 
    -4.9090950526377322      6938.8522444067812                      -0                       0 

                 ycomax                  ycorms                  deltap                 synch_1 
                      0                       0                       0                       0 

                synch_2                 synch_3                 synch_4                 synch_5 
                      0                       0                       0                       0 

                synch_6                 synch_8                  nflips                   dqmin 
                      0                       0                       0                       0 

            dqmin_phase 
                      0 


! reset all tapering values 

Taper, reset;

All taper values have been reset to zero 



! Alternative method still works

Twiss, tapering, save, file="tapering.tfs";

enter Twiss module
 Initial tapering before entering Twiss 
  
iteration:   1 error:   2.134290E-10 deltap:   0.000000E+00
orbit:  -3.018286E-13  5.695089E-13  0.000000E+00  0.000000E+00 -4.063248E-10 -6.183646E-12
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
 Tapering applied, proceeding to Twiss 
  
iteration:   1 error:   2.126608E-10 deltap:   0.000000E+00
orbit:  -3.009187E-13  5.694555E-13  0.000000E+00  0.000000E+00 -4.455048E-10 -1.166410E-10
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.

++++++ table: summ

                 length                  orbit5                    alfa                 gammatr 
     97756.072627066169  4.4550481704525163e-10  6.7368976041691678e-06      385.27428822113922 

                     q1                     dq1                 betxmax                   dxmax 
     389.05942327459877     0.97242839370854939      1619.4277922426877     0.53578797772049525 

                  dxrms                  xcomax                  xcorms                      q2 
    0.12376338920965217  6.6070643274062076e-11  1.8574886412560957e-11      389.17276467241669 

                    dq2                 betymax                   dymax                   dyrms 
   -0.81165641418256373      7121.1444419741511                      -0                       0 

                 ycomax                  ycorms                  deltap                 synch_1 
                      0                       0                       0                       0 

                synch_2                 synch_3                 synch_4                 synch_5 
                      0                       0                       0                       0 

                synch_6                 synch_8                  nflips                   dqmin 
                      0                       0                       0                       0 

            dqmin_phase 
                      0 
! see if two consecutive runs alter the results

Twiss, tapering, save; 

enter Twiss module
 Initial tapering before entering Twiss 
  
iteration:   1 error:   2.134290E-10 deltap:   0.000000E+00
orbit:  -3.018286E-13  5.695089E-13  0.000000E+00  0.000000E+00 -4.063248E-10 -6.183646E-12
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
 Tapering applied, proceeding to Twiss 
  
iteration:   1 error:   2.126608E-10 deltap:   0.000000E+00
orbit:  -3.009187E-13  5.694555E-13  0.000000E+00  0.000000E+00 -4.455048E-10 -1.166410E-10
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.

++++++ table: summ

                 length                  orbit5                    alfa                 gammatr 
     97756.072627066169  4.4550481704525163e-10  6.7368976041691678e-06      385.27428822113922 

                     q1                     dq1                 betxmax                   dxmax 
     389.05942327459877     0.97242839370854939      1619.4277922426877     0.53578797772049525 

                  dxrms                  xcomax                  xcorms                      q2 
    0.12376338920965217  6.6070643274062076e-11  1.8574886412560957e-11      389.17276467241669 

                    dq2                 betymax                   dymax                   dyrms 
   -0.81165641418256373      7121.1444419741511                      -0                       0 

                 ycomax                  ycorms                  deltap                 synch_1 
                      0                       0                       0                       0 

                synch_2                 synch_3                 synch_4                 synch_5 
                      0                       0                       0                       0 

                synch_6                 synch_8                  nflips                   dqmin 
                      0                       0                       0                       0 

            dqmin_phase 
                      0 
! See effect of deltap

Twiss, tapering, deltap=1.e-3, save, file="tapering_dp.tfs";

enter Twiss module
 Initial tapering before entering Twiss 
  
iteration:   1 error:   2.134290E-10 deltap:   0.000000E+00
orbit:  -3.018286E-13  5.695089E-13  0.000000E+00  0.000000E+00 -4.063248E-10 -6.183646E-12
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
 Tapering applied, proceeding to Twiss 
  
iteration:   1 error:   1.105442E-04 deltap:   1.000000E-03
orbit:  -9.135213E-08  4.123017E-07  0.000000E+00  0.000000E+00  1.835133E-04 -7.030935E-05
  
iteration:   2 error:   6.193924E-07 deltap:   1.000000E-03
orbit:  -1.224543E-07  4.132685E-07  0.000000E+00  0.000000E+00  1.823771E-04 -7.092048E-05
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.

++++++ table: summ

                 length                  orbit5                    alfa                 gammatr 
     97756.072627066169 -0.00018237711358402414  6.7518035614360974e-06      384.84876819764219 

                     q1                     dq1                 betxmax                   dxmax 
     389.05994144349938      2.5267238136641144      1657.4217367203967     0.54451469821232379 

                  dxrms                  xcomax                  xcorms                      q2 
    0.12399229456044844  0.00049831653645340031  0.00011498785700409634      389.17726275310321 

                    dq2                 betymax                   dymax                   dyrms 
     7.3076027158119627      6848.9451700842992                      -0                       0 

                 ycomax                  ycorms                  deltap                 synch_1 
                      0                       0                   0.001                       0 

                synch_2                 synch_3                 synch_4                 synch_5 
                      0                       0                       0                       0 

                synch_6                 synch_8                  nflips                   dqmin 
                      0                       0                       0                       0 

            dqmin_phase 
                      0 


! Tapering also applied as option for matching

Beam, radiate=false;

Taper, reset;

All taper values have been reset to zero 

lagca1save = lagca1;

lagca1 = 0.5;

++++++ info: lagca1 redefined
Savebeta, label=B.IP, place=#s, sequence=FCC_E_RING;

Twiss;

enter Twiss module
  
iteration:   1 error:   7.873944E-18 deltap:   0.000000E+00
orbit:   1.622405E-28 -1.216944E-28  0.000000E+00  0.000000E+00 -9.503297E-18  1.627222E-19

++++++ table: summ

                 length                  orbit5                    alfa                 gammatr 
     97756.072627066169  9.5032970291684317e-18  6.4222910259019802e-06       394.5981175902034 

                     q1                     dq1                 betxmax                   dxmax 
     389.08600001979499     0.96792710790469039      1622.6651577725313     0.53578485365675643 

                  dxrms                  xcomax                  xcorms                      q2 
    0.12374170777759069  2.4746270323006045e-18   6.094418511627589e-19      389.20000003940248 

                    dq2                 betymax                   dymax                   dyrms 
    -1.6439536764484939      7128.7280224570941                       0                       0 

                 ycomax                  ycorms                  deltap                 synch_1 
                      0                       0                       0                       0 

                synch_2                 synch_3                 synch_4                 synch_5 
                      0                       0                       0                       0 

                synch_6                 synch_8                  nflips                   dqmin 
                      0                       0                       0                       0 

            dqmin_phase 
                      0 
lagca1 = lagca1save + 0.05;

++++++ info: lagca1 redefined
Beam, radiate=true;



Match, sequence=FCC_E_RING, BETA0 = B.IP, tapering;

START MATCHING

number of sequences: 1
sequence name: fcc_e_ring
number of beta0s: 1
BETA0 name: b.ip
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
 	Vary, name=LAGCA1, step=1.0E-7;

!	Vary, name=LAGCA2, step=1.0E-7;

	Constraint, sequence=FCC_E_RING, range=#e, PT=0.0;

	Jacobian, tolerance=1.0E-16, calls=3000;

number of variables:    1
user given constraints: 1
total constraints:      1

START JACOBIAN:

 JACOBIAN Strategy =           3
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
Initial Penalty Function =   0.2218013001060188E+01


++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
 Solve system with            1 con,           1 var
 Rank             1   Condition number    1.0000000000000000     
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
 Step length   0.11775834606835994     
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
call:     2 Dx =   0.11775835E+00  Penalty function =  0.3261253406528602E-01
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
 Solve system with            1 con,           1 var
 Rank             1   Condition number    1.0000000000000000     
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
 Step length    1.9425459359204034E-002
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
call:     3 Dx =   0.19425459E-01  Penalty function =  0.2891742501661410E-04
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
 Solve system with            1 con,           1 var
 Rank             1   Condition number    1.0000000000000000     
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
 Step length    6.1551705587965821E-004
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
call:     4 Dx =   0.61551706E-03  Penalty function =  0.3269670989654965E-10
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
 Solve system with            1 con,           1 var
 Rank             1   Condition number    1.0000000000000000     
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
 Step length    6.5587158991316484E-007
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
call:     5 Dx =   0.65587159E-06  Penalty function =  0.1694055282701554E-15
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
 Solve system with            1 con,           1 var
 Rank             1   Condition number    1.0000000000000000     
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
 Step length    1.4929700722272944E-009
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
call:     6 Dx =   0.14929701E-08  Penalty function =  0.8427446293186903E-21
 ++++++++++ JACOBIAN ended: converged successfully
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
 Final difference norm:  0.22360679579732221     
Endmatch;

++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.

MATCH SUMMARY

Node_Name                  Constraint   Type  Target Value       Final Value        Penalty
--------------------------------------------------------------------------------------------------
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.
fcc_e_ring$end:1           pt           4     0.00000000E+00    -2.90300642E-13     8.42744629E-22


Final Penalty Function =   8.42744629e-22





Variable                 Final Value  Initial Value Lower Limit  Upper Limit 
--------------------------------------------------------------------------------
lagca1                    3.56701e-01  4.06701e-01 -1.00000e+20  1.00000e+20

END MATCH SUMMARY

VARIABLE "TAR" SET TO   8.42744629e-22
	

Twiss, file="fcc_radiate.tfs", tapering;

enter Twiss module
 Initial tapering before entering Twiss 
  
iteration:   1 error:   8.151370E-11 deltap:   0.000000E+00
orbit:  -3.003396E-13  5.691522E-13  0.000000E+00  0.000000E+00 -5.835406E-11 -1.068859E-10
++++++ warning: TWCLORB:  Horizontal plane might be unstable More information with the debug flag on.                                                                                                                                                                               
++++++ warning: TWCLORB:  Vertical plane might be unstable More information with the debug flag on.                                                                                                                                                                                 
++++++ warning: TWCLORB:  Longitudinal plane might be unstable. Try change lag with 0.5. More information with the debug flag on.                                                                                                                                                   
 Tapering applied, proceeding to Twiss 
  
iteration:   1 error:   1.611199E-10 deltap:   0.000000E+00
orbit:  -3.002945E-13  5.690385E-13  0.000000E+00  0.000000E+00 -8.084385E-11 -2.212543E-10
++++++ warning: TWCPGO:  TWISS uses the RF system or synchrotron radiation only to find the closed orbit, for optical calculations it ignores both.

++++++ table: summ

                 length                  orbit5                    alfa                 gammatr 
     97756.072627066169  8.0843852658014554e-11   6.736897604836872e-06      385.27428820204665 

                     q1                     dq1                 betxmax                   dxmax 
     389.05942327457979     0.97242849740356196      1619.4277927352723     0.53578797743860318 

                  dxrms                  xcomax                  xcorms                      q2 
    0.12376338922268312  6.7989209701224003e-11  1.8479825421144365e-11      389.17276467247416 

                    dq2                 betymax                   dymax                   dyrms 
   -0.81165615980593941      7121.1444417576822                      -0                       0 

                 ycomax                  ycorms                  deltap                 synch_1 
                      0                       0                       0                       0 

                synch_2                 synch_3                 synch_4                 synch_5 
                      0                       0                       0                       0 

                synch_6                 synch_8                  nflips                   dqmin 
                      0                       0                       0                       0 

            dqmin_phase 
                      0 
Save, sequence=FCC_E_RING, file="tapered.seq";

++++++ warning: SAVE makes all previous USE invalid !  


Stop;


  Number of warnings: 117
7 in C and 110 in Fortran

  ++++++++++++++++++++++++++++++++++++++++++++
  +          MAD-X finished normally         +
  ++++++++++++++++++++++++++++++++++++++++++++
