%%\title{MAD-X PTC\_TWISS Module}
%  Created by: Valery KAPIN, 21-Mar-2006 
%  Changed by: Frank Schmidt 04-Apr-2006 
%  \href{mailto:kapin@itep.ru}{ V.Kapin}(ITEP) and 
%  \href{mailto:Frank.Schmidt@cern.ch}{ F.Schmidt}, March  2006

%  Changed by: Piotr and Ghislain 24-Jan-2014



\chapter{PTC\_TWISS Module: Ripken Optics Parameters}


The \textbf{PTC\_TWISS module} of MAD-X [\hyperlink{F. Schmidt}{a}] is
based on the PTC code and is supplementary to the TWISS module of MAD-X. 
In \texttt{PTC\_TWISS} the Twiss parameters are calculated according to
the formalism of G.~Ripken, developped in 1970 \cite{Ripken1970} and
most accessible in \cite{Ripken1988} Ref. [\hyperlink{G. Ripken}{b}]. 

%% These parameters were available in MAD8 using the TWISS3 command. This
%% module is a typical example of the advantages when using PTC and its
%% Normal Form technique (and of course the object-oriented Fortran90
%% coding): once the rather modest programming has been performed the Twiss
%% calculation will always be automatically correct for all machine
%% conditions like closed orbit, coupling or after a new element has been
%% introduced into the code. In a traditional coding like in MAD8 this
%% depends on reprogramming and modifying the code at various places which
%% is inherently error-prone.  

PTC\_TWISS tracks a special representation of the beam in three degrees
of freedom. It works on the coupled lattice functions which are
essentially the projections of the lattice functions for the eigen-modes
on the three planes.  

PTC\_TWISS lists the projections of the ellipses of motion
onto the three planes (\textit{x}, \textit{p$_x$}), (\textit{y},
\textit{p$_y$}), (\textit{t}, \textit{p$_t$}) expressed via
Ripken's parameters \textit{b$_{k,j}$},
\textit{a$_{k,j}$}, \textit{g$_{k,j}$} along with
the phase advances \textit{m$_j$} in selected positions, where
index \textit{k} = 1...3 refers to the plane (\textit{x}, \textit{y},...),
and the index \textit{j} = 1...3 denotes the eigen-mode. 
The PTC\_TWISS command also calculates the dispersion values 
\textit{D}$_1$,...,\textit{D}$_4$. 
In MAD-X commands and tables, these parameters are denoted as  
\texttt{beta11, ..., beta33, alfa11, ..., alfa33, gama11, ..., gama33,
  mu1, ..., mu3, disp1, ..., disp4}, respectively. 

The Ripken parametrization can be transformed into the Edwards-Teng
parametrization (used in the module \texttt{TWISS} of MAD-X) using the formulae of
Ref. [\hyperlink{V.A. Lebedev}{d}]. 
The parameters are noted as  
\texttt{betx, bety, alfx, alfy} and the coupling matrix: R11, R12, R21
and R22. In absence of coupling, the following holds:  
\texttt{betx=beta11}, \texttt{bety=beta22}, 
\texttt{alfx=alfa11} and \texttt{alfy=alfa22}.

PTC\_TWISS can also compute the deltap/p-dependency of the Twiss
parameters. The column names \texttt{beta11p, ..., beta33p,
  alfa11p, ..., alfa33p, gama11p, ..., gama33p} denote the derivatives of
the optics parameters with respect to deltap/p. If one is interested in
evaluating deltap/p-dependency of the Twiss parameters, one must ensure
that the order (no) of the map is set to 2 at least. 
The derivatives of the dispersion with respect to deltap/p have column
names: \texttt{disp1p, ..., disp4p}. 
Second and third order derivatives have respective column names:  
\texttt{disp1p2, ..., disp4p2} for the second order, and 
\texttt{disp1p3, ..., disp4p3} for the third order.

In addition, we compute momentum compaction factor $\alpha_c$ up to 1st
order (for icase=5) or 3rd order (for icase=56). The values appear in
the header of the ptc\_twiss output file (zero means the value has not
been computed). 

This feature is currently only available in the development version. [To
  be checked]

For clarification: in the 4-D case, there is the following
correspondence between MAD-X and the Ripken's notations:  
\texttt{beta11}\texttt{®}\textit{b}$_\textit{x}I$, 
\texttt{beta12}\texttt{®}\textit{b}$_\textit{x}II$, 
\texttt{beta21}\texttt{®}\textit{b}$_\textit{y}I$, 
\texttt{beta22}\texttt{®}\textit{b}$_\textit{y}II$,  
while in the uncoupled 4-D case 
\texttt{beta11} is the same as the classical \textit{b$_x$} (\texttt{betx}) 
and \texttt{beta22 }is \textit{b$_y$} (\texttt{bety}), while 
\texttt{beta12} and \texttt{beta21} are zero. 
When there is coupling all 
\texttt{betaNN} are non-zero and \texttt{beta11}, \texttt{beta22} 
are distinctively different from \textit{b$_x $}, \textit{b$_y$}, respectively. 

PTC\_TWISS also tracks the eigenvectors and prints them to Twiss table
according to the SELECT command (flag=ptc\_twiss). Either all 36
components or particular components of the eigenvectors can be selected
with eign or eign\textit{ij}, respectively (\textit{j} = number of
eigenvector, \textit{i} = number of coordinate \{\textit{x}, \textit{
  p$_x$}, \textit{y}, \textit{p$_y$}, \textit{t},\textit{p$_t$}\}). 

For ring lattices, PTC\_TWISS computes momentum compaction, transition
energy, as well as other one-turn characteristics such as the tunes
(Q1,Q2 and if icase=6 with cavity Qs) and chromaticities (for no$\geq 2$).  

\section{Synopsis}

\begin{verbatim}
PTC_CREATE_UNIVERSE;
PTC_CREATE_LAYOUT, model=integer, method=integer, nst=integer, [exact];
...
SELECT, flag=ptc_twiss, clear;
SELECT, flag=ptc_twiss, column=name, s,   
        beta11,...,beta33,alfa11,..., alfa33,gama11,...,gama33,                 
        beta11p,...,beta33p,alfa11p,...,alfa33p,gama11p,...,gama33p,                 
        mu1,...,mu3,                 
        disp1,...,disp4,                 
        disp1p,...,disp4p,                 
        disp1p2,...,disp4p2,                 
        disp1p3,...,disp4p3,                 
        [eign], eign11, ...,eign16,...,eign61,...,eign66;
...
PTC_TWISS;
...
PTC_END;
\end{verbatim}

\section{PTC\_TWISS}
 
\begin{verbatim}
PTC_TWISS, icase=integer, deltap=double, closed_orbit, slice_magnets, 
           range=string, file[=string], table[=string],
           initial_matrix_table, initial_matrix_manual, 
           initial_map_manual, beta0=string, map_table[=logical],  
           ignore_map_orbit, ring_parameters,
           betx=double, alfx=double, mux=double,   
           bety=double, alfy=double, muy=double,     
           dx=double,  dpx=double, dy=double, dpy=double,
           x=double, px=double, y=double, py=double, t=double, pt=double,
           re11=double, re12=double, ... , re16=double,
           ...
           re61=double, re62=double, ... , re66=double; 
\end{verbatim}


{\bf Description} \\
The \texttt{PTC\_TWISS} command causes computation of the Twiss
parameters in Ripken's style. It operates on the working beam line
defined in the latest \href{../control/general.html#use}{USE}
command. Several options can be specified, the most important
being \texttt{icase, deltap, closed\_orbit, slice\_magnets, no} and
\texttt{file, table}.  
(see the description of these options below). 
Other options should be specified  for particular tasks. 
Applications for the \texttt{PTC\_TWISS} command are similar to the
\texttt{\href{../twiss/twiss.html}{TWISS}}-command. 
The PTC\_TWISS can be applied to two basic tasks. It can calculate either a
\hyperlink{Periodic_Solution}{periodic solution} or a
\hyperlink{Initial_Conditions}{solution with initial conditions}. 


{\bf Options}

\begin{madlist}
  \ttitem{ICASE} = integer (Default: 4) \\ 
  the dimensionality of the phase-space (4, 5 or 6). \\ 
  Note that {\tt icase} is internally set to 56 when attempting to set
  icase=6 with no cavity, and {\tt icase} is internally set to 4 when
  attempting to set icase=6 with an RF cavity with zero voltage.  

  \ttitem{NO}=integer (Default: 1) \\
  the order of the map. For evaluating
  the derivatives of the Twiss parameter w.r.t. deltap/p, e.g. for
  evaluating the chromaticities, the order must
  be at least equal to 2.

\ttitem{DELTAP}=double (Default: 0.0) \\
relative momentum offset for reference closed orbit. 

\ttitem{CLOSED\_ORBIT}=logical (Default: .false.) \\
the switch to turn on the closed orbit calculation
(\hyperlink{Periodic_Solution}{periodic solution} ONLY).  

\ttitem{DELTAP\_DEPENDENCY}=logical (Default: .false.) \\
the switch to turn on computation of the Twiss and
dispersion derivatives w.r.t. deltap/p. Derivation formula assume that
icase=5, so that deltap/p is supplied as a parameter. 

\ttitem{SLICE\_MAGNETS}=logical (Default: .false.) \\
%% the switch to turn on the evaluation of Twiss
%% parameters at each thin slice inside successive magnets, instead of at
%% the middle of each magnet. Slices are located at the so-called
%% 'integration nodes' determined by the number of steps (nst) selected
%% when creating the PTC layout. Note that extremities and fringes are
%% skipped, whereas only the inner slices are kept. 
Turns on the evaluation of Twiss parameters at each integration step
inside magnets, in addition to the end face. 
The number of slices is determined by the number of steps (nst) that can
be separately defined for each element, or otherwise set by nst
parameter when creating the PTC layout. 
Note that the orbit rms calculated in this mode counts as valid data
points both the end of the previous element and the entrance of the
current element. Since the first integration node is always at the
entrance of the magnet (after position offset and fringe effects are
calculated) which corresponds to the same s position (and usually
optical functions) as the end of the previous element, the points at the
interface between magnets are included twice in the rms calculation. 

\ttitem{CENTER\_MAGNETS}=logical (Default: .false.) \\
the switch to turn on the evaluation of Twiss
parameters at the middle of each magnet. This relies on internal slicing
and 'integration nodes' as determined by the number of steps (nst)
selected when creating the PTC layout. This number is assumed to be even
otherwise the program issues a warning. 

\ttitem{FILE}[=string] (Default: .false.) \\
if the FILE option is omitted, no output is written to file. \\
If the FILE option is present, the optional argument is the name of the
file for printing the PTC\_TWISS output. The default file name is
``ptc\_twiss''. 

\ttitem{TABLE}[=string] (Default: .false.) \\
if the TABLE option is omitted, no output is written to an internal
table. \\ 
If the TABLE option is present, the optional argument is the name of the
internal table for PTC\_TWISS variables. The default table name is
``ptc\_twiss''. 

\ttitem{SUMMARY\_FILE}[=string] (Default: .false.) \\
if the SUMMARY\_FILE option is omitted, no summary output is written to
file. \\  
If the SUMMARY\_FILE option is present, the optional argument is the
name of the file for printing the PTC\_TWISS\_SUMMARY table output. The
default file name is ``ptc\_twiss\_summary'' 

\ttitem{SUMMARY\_TABLE}[=string] (Default: .false.) \\
if the option SUMMARY\_TABLE is omitted, no summary output is written to
an internal table. \\
If the option SUMMARY\_TABLE is present, the optional argument is the name
of the internal summary table for PTC\_TWISS\_SUMMARY variables. The
default table name is ``ptc\_twiss\_summary''.  

\ttitem{RANGE}=string\href{../Introduction/ranges.html#range} (Default:
  \(\#S/\#E\)) \\ 
specifies a segment of beam-line for the PTC\_TWISS calculation.

\ttitem{INITIAL\_MATRIX\_TABLE}=logical (Default: .false.) \\
Reading the transfer map from table called map\_table created by
preceding PTC\_TWISS or PTC\_NORMAL command. The table can be also read
before hand from files using READTABLE command.

\ttitem{INITIAL\_MATRIX\_MANUAL}=logical (Default: .false.) \\ 
Using the input variables RE11, \ldots ,RE66 (see next entry) as the
transfer matrix.

\ttitem{INITIAL\_MAP\_MANUAL}=logical (Default: .false.) \\
Using the input map stored beforehand in file fort.18 (e.g. by some
initial run of \href{../ptc_normal/ptc_normal.html}{PTC\_NORMAL}). 

\ttitem{IGNORE\_MAP\_ORBIT}=logical (default: .false.) \\
Ignore the orbit in the map and use instead closed orbit, if requested,
or otherwise specified with x,px,y,p,t,dt parameters. 

\ttitem{RE11,..., RE66} = doubles (Default: Unit Matrix) \\ 
Values of the \(6\times 6\) transfer matrix.  

\ttitem{BETA0}=string (Default: beta0) \\
The name of the \texttt{BETA0}-block containing the Twiss
parameters to be used as input. When icase=6, this information must be
complemented by supplying a value for 'betz' on the ptc\_twiss command
line.

\ttitem{MAP\_TABLE}=logical (Default: .false.)\\
If true, save the one-turn-map to table "map\_table".
This one-turn-map can then be used as starting condition for a
subsequent \texttt{ptc\_twiss}, see \texttt{INITIAL\_MATRIX\_TABLE}
parameter of this command.  

\ttitem{betx, alfx, mux, bety, alfy, muy, dx, dpx, dy, dpy} =doubles
  (Default: 0) \\ 
\href{../Introduction/bibliography.html#edwards}{Edwards and Teng} 
\href{../twiss/twiss.html}{Twiss and dispersion parameters}:  
\textit{$\beta_{x,y}$}, \textit{$\alpha_{x,y}$},
\textit{$\mu_{x,y}$}, \textit{D$_{x,y}$},  \textit{D$_{px,py}$}.

\ttitem{RING\_PARAMETERS}=logical (default: .false.) \\
Forces computation of ring parameters ($\gamma_{tr}$, $\alpha_c$, etc.).

\ttitem{x, px, y, py, t, pt} = doubles (Default: 0.0) \\
The \href{../Introduction/tables.html#canon}{\textbf{canonical}} coordinates
of the initial orbit. 

\end{madlist}


{\bf Remarks} \\
{\bf ICASE}: It can be internally corrected by the
  code. For example, if RF cavity has the voltage set to zero and
  for \hyperlink{ICASE}{icase}=6, the code sets
  \hyperlink{ICASE}{icase}=4. \\


\section{\href{Periodic_Solution}{Periodic Solution}} 
	
\begin{verbatim}
PTC_TWISS, icase=integer, deltap=double, closed_orbit,
           range=string, file[=string], table[=string];
\end{verbatim}


{\bf Description} \\
% <strong>TRACK, DELTAP= double, ONEPASS, DUMP, ONETABLE, FILE= string;</strong> (MADX version 1)<br />
% <strong>TRACK, DELTAP= double, ONEPASS, DAMP, QUANTUM, DUMP, ONETABLE, FILE= string;</strong> (MADX version 2)<br /> 
This is the simplest form of the \texttt{PTC\_TWISS} command, which
computes the periodic solution for a specified beam line. It may
accept all basic options described in the above table. 


\section{\href{Slicing_Magnets}{Evaluation of Twiss parameters inside magnets}}

\begin{verbatim}
PTC_TWISS, icase=integer, deltap=double, closed_orbit, slice_magnets, 
           range=string, file[=string], table[=string]; 
\end{verbatim}



{\bf Description} \\
% <strong>TRACK, DELTAP= double, ONEPASS, DUMP, ONETABLE, FILE= string;</strong> (MADX version 1)<br />
% <strong>TRACK, DELTAP= double, ONEPASS, DAMP, QUANTUM, DUMP, ONETABLE, FILE= string;</strong> (MADX version 2)<br /> 
This computes the periodic solution for a specified beam
line and evaluates the Twiss parameters at each thin-slice
(a.k.a "integration-node") inside magnets. The number of such
integration-nodes is given by the number of steps (nst)
selected when creating the PTC layout. All other basic
options described in the above table may be selected.


{\bf Example} \\
An example is found in the
\href{http://madx.web.cern.ch/madx/madX/examples/ptc_twiss/SliceMagnets/}
%\href{http://isscvs.cern.ch/cgi-bin/viewcvs-all.cgi/madX-examples/REF/ptc_twiss/SliceMagnets/?root=madx-examples}
{\texttt{PTC\_TWISS} Examples} repository. 



\section{Solution with \href{Initial_Conditions}{Initial Conditions}}

%% \subsection{Code Logic}
%% \begin{verbatim}
%%     IF ("initial_matrix_table" = ON .AND.
%%     &    {the map-table exists})   THEN
%%        (from a Map-Table)

%%     ELSEIF("initial_map_manual" = ON) THEN
%%        (from a Given Map File)

%%     ELSEIF("initial_matrix_manual" = ON) THEN
%%        (from a Given Matrix)

%%     ELSEIF(BETA0 block = ON) THEN
%%        (from Twiss Parameters via BETA0-block)

%%     ELSE
%%        (from Given Twiss Parameters)

%%     ENDIF
%% \end{verbatim}

Initial conditions can be supplied in different ways. 
Naturally only one of the methods below can be used at a time, and they
can not be mixed. 
In this mode it is assumed that the lattice is a line and no ring
parameters are evaluated (their values are set to -1000000), unless
parameter \texttt{RING\_PARAMETERS} is set to true.  
It forces computation of closed solution for the resulting map.  
If such solution does not exist, the routine shall report an error and
exit. 

\subsection{Initial Values from the Given Twiss Parameters}

\begin{verbatim}
PTC_TWISS, icase=integer, deltap=double, closed_orbit, 
           range=string, file[=string], table[=string],
           betx=double, alfx=double, mux=double, 
           bety=double, alfy=double, muy=double, 
           dx=double, dpx=double, dy=double, dpy=double,
           x=double, px=double, y=double, py=double, t=double, pt=double;
\end{verbatim}

{\bf Description} \\
% <strong>TRACK, DELTAP= double, ONEPASS, DUMP, ONETABLE, FILE= string;</strong> (MADX version 1)<br />
% <strong>TRACK, DELTAP= double, ONEPASS, DAMP, QUANTUM, DUMP, ONETABLE, FILE= string;</strong> (MADX version 2)<br /> 
\texttt{PTC\_TWISS} calculates a solution with initial conditions
given by the Twiss parameters, which are explicitly typed on the
command line. Note, that this case is also limited to uncoupled
motion of the preceding ring or beam-line. 

{\bf Example}  \\
An example is found in the
\href{http://madx.web.cern.ch/madx/madX/examples/ptc_twiss/}
%\href{http://cern.ch/frs/mad-X_examples/ptc_twiss}
{\texttt{PTC\_TWISS} Examples} 
in the folder
\href{http://madx.web.cern.ch/madx/madX/examples/ptc_twiss/Example2}
%\href{http://cern.ch/frs/mad-X_examples/ptc_twiss/Example2/}
{"Example2"}.  


\subsection{Initial Values from a Map-Table}
Initial Values in a \href{map-table}{Map-Table} can be obtained by a preceding
\href{../ptc_normal/ptc_normal.html}{PTC\_NORMAL} command.

\begin{verbatim}
PTC_TWISS, icase=integer, deltap=double, closed_orbit, 
           range=string, file[=string], table[=string],
           initial_matrix_table;
\end{verbatim}

{\bf Description} \\ 
% <strong>TRACK, DELTAP= double, ONEPASS, DUMP, ONETABLE, FILE= string;</strong> (MADX version 1)<br />
% <strong>TRACK, DELTAP= double, ONEPASS, DAMP, QUANTUM, DUMP, ONETABLE, FILE= string;</strong> (MADX version 2)<br /> 
\texttt{PTC\_TWISS} calculates a solution with initial conditions given
as a map-table of preceding ring or beam-line. It requires the input
option \texttt{initial\_matrix\_table} and an existence of the map-table
in memory, which was generated by a preceding
\texttt{\href{../ptc_normal/ptc_normal.html}{PTC\_NORMAL}} command. 

{\bf Example} \\
An example is found in the
\href{http://madx.web.cern.ch/madx/madX/examples/ptc_twiss/}
%\href{http://cern.ch/frs/mad-X_examples/ptc_twiss}
{\texttt{PTC\_TWISS} Examples} in the folder
\href{http://madx.web.cern.ch/madx/madX/examples/ptc_twiss/Example3}
%\href{http://cern.ch/frs/mad-X_examples/ptc_twiss/Example3/}
{"Example3"}. 


\subsection{Initial Values from a Map-File}

Initial Values in a \href{Given_Map_File}{Map-File} can be obtained by a preceding
\href{../ptc_normal/ptc_normal.html}{PTC\_NORMAL} command.

\begin{verbatim}
PTC_TWISS, icase=integer, deltap=double, closed_orbit, 
           range=string, file[=string], table[=string],
           initial_map_manual;
\end{verbatim}

{\bf Description} \\
% <strong>TRACK, DELTAP= double, ONEPASS, DUMP, ONETABLE, FILE= string;</strong> (MADX version 1)<br />
% <strong>TRACK, DELTAP= double, ONEPASS, DAMP, QUANTUM, DUMP, ONETABLE, FILE= string;</strong> (MADX version 2)<br /> 
\texttt{PTC\_TWISS} calculates a solution with initial
conditions given as a map-file fort.18 obtained from a
preceding ring or beam-line. It requires the input option
\texttt{initial\_map\_manual} and an existence of the map-file
named a fort.18 file, which was generated by a
preceding
\texttt{\href{../ptc_normal/ptc_normal.html}{PTC\_NORMAL}}
command. 

{\bf Example} \\
An example is found in the
\href{http://madx.web.cern.ch/madx/madX/examples/ptc_twiss/}
%\href{http://cern.ch/frs/mad-X_examples/ptc_twiss}
{\texttt{PTC\_TWISS} Examples} in the folder
\href{http://madx.web.cern.ch/madx/madX/examples/ptc_twiss/Example3}
%\href{http://cern.ch/frs/mad-X_examples/ptc_twiss/Example3/}
{"Example3"}. 


\subsection{Initial Values from a Given Matrix}

\begin{verbatim}
PTC_TWISS, icase=integer, deltap=double,     
           closed_orbit, range=string, file=string, table=string,
           initial_matrix_manual, 
           re11=double, re12=double, ... , re16=double,
           ...
           re61=double, re62=double, ... , re66=double;
\end{verbatim}

{\bf Description} \\ 
% <strong>TRACK, DELTAP= double, ONEPASS, DUMP, ONETABLE, FILE= string;</strong> (MADX version 1)<br />
% <strong>TRACK, DELTAP= double, ONEPASS, DAMP, QUANTUM, DUMP, ONETABLE, FILE= string;</strong> (MADX version 2)<br /> 
\texttt{PTC\_TWISS} calculates a solution with initial conditions given
by the matrix, which is "manually" entered on the command-line. It
requires the option \texttt{initial\_matrix\_manual}. MAD-X expects a
symplectic 6x6 transfer matrix as input. 

{\bf Example}  \\
An example is found in the
\href{http://madx.web.cern.ch/madx/madX/examples/ptc_twiss/}
%\href{http://cern.ch/frs/mad-X_examples/ptc_twiss}
{\texttt{PTC\_TWISS} Examples} in the folder
\href{http://madx.web.cern.ch/madx/madX/examples/ptc_twiss/Example4}
%\href{http://cern.ch/frs/mad-X_examples/ptc_twiss/Example4/}
{"Example4"}. 


\subsection{Initial Values from Twiss Parameters via BETA0-block}

\begin{verbatim}
 PTC_TWISS, icase=integer, deltap=double, closed_orbit, 
            range=string, file[=string], table[=string],
            beta0=string ;
\end{verbatim}
      
{\bf Description} \\
% <strong>TRACK, DELTAP= double, ONEPASS, DUMP, ONETABLE, FILE= string;</strong> (MADX version 1)<br />
% <strong>TRACK, DELTAP= double, ONEPASS, DAMP, QUANTUM, DUMP, ONETABLE, FILE= string;</strong> (MADX version 2)<br /> 
\texttt{PTC\_TWISS} calculates a solution with initial conditions given
by Twiss parameters, which are transferred from the
\texttt{BETA0}-block.   
The data in the the \texttt{BETA0}-block have to be filled by a
combination of the \href{../control/general.html#savebeta}{SAVEBETA} and 
\href{../twiss/twiss.html}{TWISS} commands of a preceding ring or
beam-line. Note, that this case is limited to uncoupled motion of the
preceding machine.  

{\bf Example} \\
An example is found in the
\href{http://madx.web.cern.ch/madx/madX/examples/ptc_twiss/}
%\href{http://cern.ch/frs/mad-X_examples/ptc_twiss}
{\texttt{PTC\_TWISS} Examples} in the folder
\href{http://madx.web.cern.ch/madx/madX/examples/ptc_twiss/Example1}
%\href{http://cern.ch/frs/mad-X_examples/ptc_twiss/Example1/}
{"Example1"}. 



\section{References for PTC\_TWISS}

\begin{enumerate}
   \item \href{F._Schmidt}{F. Schmidt},
     "`\href{http://cern.ch/madx/doc/MPPE012.pdf}{MAD-X PTC
     Integration}'',   Proc. of the 2005 PAC Conference in Knoxville,
     USA, pp.1272. 
   \item \href{G. Ripken}{G.Ripken} and F.Willeke,
     "\href{http://cern.ch/madx/doc/1988_Ripken.pdf}{Methods of   Beam
     Optics}", DESY 88–114, 1988. 
   \item \href{K._Zhang}{K. Zhang}, "PTC twiss with initial TWISS
     parameters",
     \href{http://cern.ch/frs/MAD-X_minutes/Meeting-13/minutes.html}{
       MAD-X Meeting 13 (04.07.2005)}, slides in
     \href{http://cern.ch/frs/MAD-X_minutes/Meeting-13/Input_of_PTC_TWISS_module.ppt}{
       ppt}. 
   \item \href{V.A. Lebedev}{V.A.Lebedev} and S.A.Bogacsz,
     "\href{http://cern.ch/madx/doc/1748-0221_5_10_P10010.pdf}{Betatron
     motion with coupling of horizontal and vertical degrees of
     motion}", Thomas Jefferson National Accelerator Facility 2010. 
\end{enumerate}


{\bf See Also} \\
\texttt{\href{../twiss/twiss.html}{TWISS}},
\href{http://madx.web.cern.ch/madx/madX/examples/ptc_twiss/}
%\href{http://cern.ch/frs/mad-X_examples/ptc_twiss}
{\texttt{PTC\_TWISS} Examples}. 




